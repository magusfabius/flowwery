{"version":3,"file":"util-logger.js","sources":["../src/util-logger.js"],"sourcesContent":["import {config} from \"@onflow/config\"\n\nexport const LEVELS = Object.freeze({\n  debug: 5,\n  info: 4,\n  log: 3,\n  warn: 2,\n  error: 1,\n})\n\nconst buildLoggerMessageArgs = ({title, message}) => {\n  return [\n    `\n    %c${title}\n    ============================\n\n    ${message}\n\n    ============================\n    `\n      .replace(/\\n[^\\S\\r\\n]+/g, \"\\n\")\n      .trim(),\n    ,\n    \"font-weight:bold;font-family:monospace;\",\n  ]\n}\n\nexport const log = async ({title, message, level, always = false}) => {\n  const configLoggerLevel = await config.get(\"logger.level\", LEVELS.warn)\n\n  // If config level is below message level then don't show it\n  if (!always && configLoggerLevel < level) return\n\n  const loggerMessageArgs = buildLoggerMessageArgs({title, message})\n\n  switch (level) {\n    case LEVELS.debug:\n      console.debug(...loggerMessageArgs)\n      break\n    case LEVELS.info:\n      console.info(...loggerMessageArgs)\n      break\n    case LEVELS.warn:\n      console.warn(...loggerMessageArgs)\n      break\n    case LEVELS.error:\n      console.error(...loggerMessageArgs)\n      break\n    default:\n      console.log(...loggerMessageArgs)\n  }\n}\n\nlog.deprecate = ({\n  pkg,\n  subject,\n  transition,\n  level = LEVELS.warn,\n  message = \"\",\n  callback = null,\n}) => {\n  const capitalizeFirstLetter = string => {\n    return string.charAt(0).toUpperCase() + string.slice(1)\n  }\n\n  const logMessage = () =>\n    log({\n      title: `${pkg ? pkg + \" \" : \"\"}Deprecation Notice`,\n      message: `\n      ${\n        subject\n          ? `${capitalizeFirstLetter(\n              subject\n            )} is deprecated and will cease to work in future releases${\n              pkg ? \" of \" + pkg : \"\"\n            }.`\n          : \"\"\n      }${message ? \"\\n\" + message : \"\"}${\n        transition\n          ? `\\nYou can learn more (including a guide on common transition paths) here: ${transition}`\n          : \"\"\n      }\n    `.trim(),\n      level,\n    })\n\n  if (typeof callback === \"function\") {\n    return async (...args) => {\n      await logMessage()\n      return await callback(...args)\n    }\n  }\n  return logMessage()\n}\n"],"names":["LEVELS","Object","freeze","debug","info","log","warn","error","buildLoggerMessageArgs","title","message","replace","trim","_asyncToGenerator","_regeneratorRuntime","level","always","config","get","configLoggerLevel","loggerMessageArgs","console","_toConsumableArray","deprecate","pkg","subject","transition","callback","capitalizeFirstLetter","string","charAt","toUpperCase","slice","logMessage"],"mappings":";;;;;;;;;;;;;;;IAEaA,MAAM,GAAGC,MAAM,CAACC,MAAP,CAAc;AAClCC,EAAAA,KAAK,EAAE,CAD2B;AAElCC,EAAAA,IAAI,EAAE,CAF4B;AAGlCC,EAAAA,GAAG,EAAE,CAH6B;AAIlCC,EAAAA,IAAI,EAAE,CAJ4B;AAKlCC,EAAAA,KAAK,EAAE,CAAA;AAL2B,CAAd,EAAf;;AAQP,IAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAsB,IAAA,EAAA;EAAA,IAApBC,KAAoB,QAApBA,KAAoB;MAAbC,OAAa,QAAbA,OAAa,CAAA;AACnD,EAAA,OAAO,CACL,UACID,CAAAA,MAAAA,CAAAA,KADJ,EAIEC,4CAAAA,CAAAA,CAAAA,MAAAA,CAAAA,OAJF,gDAQGC,OARH,CAQW,eARX,EAQ4B,IAR5B,CASGC,CAAAA,IATH,EADK,GAYL,yCAZK,CAAP,CAAA;AAcD,CAfD,CAAA;;IAiBaP,GAAG,gBAAA,YAAA;EAAA,IAAG,KAAA,GAAAQ,qCAAA,eAAAC,uCAAA,CAAA,IAAA,CAAA,SAAA,OAAA,CAAA,KAAA,EAAA;AAAA,IAAA,IAAA,QAAA,EAAA,SAAA,EAAA,SAAA,EAAA,SAAA,EAAA,SAAA,CAAA;;AAAA,IAAA,IAAA,KAAA,EAAA,OAAA,EAAA,KAAA,EAAA,YAAA,EAAA,MAAA,EAAA,iBAAA,EAAA,iBAAA,CAAA;;AAAA,IAAA,OAAAA,uCAAA,CAAA,IAAA,CAAA,SAAA,QAAA,CAAA,QAAA,EAAA;AAAA,MAAA,OAAA,CAAA,EAAA;AAAA,QAAA,QAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;AAAA,UAAA,KAAA,CAAA;AAAQL,YAAAA,KAAR,GAAQA,KAAAA,CAAAA,KAAR,EAAeC,OAAf,SAAeA,OAAf,EAAwBK,KAAxB,GAAA,KAAA,CAAwBA,KAAxB,EAA+BC,YAAAA,GAAAA,KAAAA,CAAAA,MAA/B,EAA+BA,MAA/B,6BAAwC,KAAxC,GAAA,YAAA,CAAA;AAAA,YAAA,QAAA,CAAA,IAAA,GAAA,CAAA,CAAA;YAAA,OACeC,aAAM,CAACC,GAAP,CAAW,cAAX,EAA2BlB,MAAM,CAACM,IAAlC,CADf,CAAA;;AAAA,UAAA,KAAA,CAAA;YACXa,iBADW,GAAA,QAAA,CAAA,IAAA,CAAA;;AAAA,YAAA,IAAA,EAIb,CAACH,MAAD,IAAWG,iBAAiB,GAAGJ,KAJlB,CAAA,EAAA;AAAA,cAAA,QAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,cAAA,MAAA;AAAA,aAAA;;AAAA,YAAA,OAAA,QAAA,CAAA,MAAA,CAAA,QAAA,CAAA,CAAA;;AAAA,UAAA,KAAA,CAAA;YAMXK,iBANW,GAMSZ,sBAAsB,CAAC;AAACC,cAAAA,KAAK,EAALA,KAAD;AAAQC,cAAAA,OAAO,EAAPA,OAAAA;AAAR,aAAD,CAN/B,CAAA;AAAA,YAAA,QAAA,CAAA,EAAA,GAQTK,KARS,CAAA;AAAA,YAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,EAAA,KASVf,MAAM,CAACG,KATG,GAAA,EAAA,GAAA,QAAA,CAAA,EAAA,KAYVH,MAAM,CAACI,IAZG,GAeVJ,EAAAA,GAAAA,QAAAA,CAAAA,EAAAA,KAAAA,MAAM,CAACM,IAfG,GAkBVN,EAAAA,GAAAA,QAAAA,CAAAA,EAAAA,KAAAA,MAAM,CAACO,KAlBG,GAAA,EAAA,GAAA,EAAA,CAAA;AAAA,YAAA,MAAA;;AAAA,UAAA,KAAA,EAAA;AAUb,YAAA,CAAA,QAAA,GAAAc,OAAO,EAAClB,KAAR,CAAA,KAAA,CAAA,QAAA,EAAAmB,sCAAA,CAAiBF,iBAAjB,CAAA,CAAA,CAAA;;AAVa,YAAA,OAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA;;AAAA,UAAA,KAAA,EAAA;AAab,YAAA,CAAA,SAAA,GAAAC,OAAO,EAACjB,IAAR,CAAA,KAAA,CAAA,SAAA,EAAAkB,sCAAA,CAAgBF,iBAAhB,CAAA,CAAA,CAAA;;AAba,YAAA,OAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA;;AAAA,UAAA,KAAA,EAAA;AAgBb,YAAA,CAAA,SAAA,GAAAC,OAAO,EAACf,IAAR,CAAA,KAAA,CAAA,SAAA,EAAAgB,sCAAA,CAAgBF,iBAAhB,CAAA,CAAA,CAAA;;AAhBa,YAAA,OAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA;;AAAA,UAAA,KAAA,EAAA;AAmBb,YAAA,CAAA,SAAA,GAAAC,OAAO,EAACd,KAAR,CAAA,KAAA,CAAA,SAAA,EAAAe,sCAAA,CAAiBF,iBAAjB,CAAA,CAAA,CAAA;;AAnBa,YAAA,OAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA;;AAAA,UAAA,KAAA,EAAA;AAsBb,YAAA,CAAA,SAAA,GAAAC,OAAO,EAAChB,GAAR,CAAA,KAAA,CAAA,SAAA,EAAAiB,sCAAA,CAAeF,iBAAf,CAAA,CAAA,CAAA;;AAtBa,UAAA,KAAA,EAAA,CAAA;AAAA,UAAA,KAAA,KAAA;AAAA,YAAA,OAAA,QAAA,CAAA,IAAA,EAAA,CAAA;AAAA,SAAA;AAAA,OAAA;AAAA,KAAA,EAAA,OAAA,CAAA,CAAA;GAAH,CAAA,CAAA,CAAA;;AAAA,EAAA,OAAA,SAAHf,GAAG,CAAA,EAAA,EAAA;AAAA,IAAA,OAAA,KAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,CAAA;AAAA,GAAA,CAAA;AAAA,CAAT,GAAA;;AA0BPA,GAAG,CAACkB,SAAJ,GAAgB,UAOV,KAAA,EAAA;EAAA,IANJC,GAMI,SANJA,GAMI;MALJC,OAKI,SALJA,OAKI;MAJJC,UAII,SAJJA,UAII;AAAA,MAAA,WAAA,GAAA,KAAA,CAHJX,KAGI;AAAA,MAHJA,KAGI,GAAA,WAAA,KAAA,KAAA,CAAA,GAHIf,MAAM,CAACM,IAGX,GAAA,WAAA;AAAA,MAAA,aAAA,GAAA,KAAA,CAFJI,OAEI;MAFJA,OAEI,8BAFM,EAEN,GAAA,aAAA;AAAA,MAAA,cAAA,GAAA,KAAA,CADJiB,QACI;MADJA,QACI,+BADO,IACP,GAAA,cAAA,CAAA;;AACJ,EAAA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAAC,MAAM,EAAI;AACtC,IAAA,OAAOA,MAAM,CAACC,MAAP,CAAc,CAAd,CAAA,CAAiBC,WAAjB,EAAA,GAAiCF,MAAM,CAACG,KAAP,CAAa,CAAb,CAAxC,CAAA;GADF,CAAA;;EAIA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAA;AAAA,IAAA,OACjB5B,GAAG,CAAC;MACFI,KAAK,EAAA,EAAA,CAAA,MAAA,CAAKe,GAAG,GAAGA,GAAG,GAAG,GAAT,GAAe,EAAvB,EADH,oBAAA,CAAA;AAEFd,MAAAA,OAAO,EAAE,UAAA,CAAA,MAAA,CAEPe,OAAO,GAAA,EAAA,CAAA,MAAA,CACAG,qBAAqB,CACtBH,OADsB,CADrB,EAAA,0DAAA,CAAA,CAAA,MAAA,CAIDD,GAAG,GAAG,MAASA,GAAAA,GAAZ,GAAkB,EAJpB,EAAA,GAAA,CAAA,GAMH,EARG,CAAA,CAAA,MAAA,CASNd,OAAO,GAAG,IAAOA,GAAAA,OAAV,GAAoB,EATrB,CAAA,CAAA,MAAA,CAUPgB,UAAU,GAAA,4EAAA,CAAA,MAAA,CACuEA,UADvE,CAAA,GAEN,EAZG,EAAA,QAAA,CAAA,CAcTd,IAdS,EAFP;AAiBFG,MAAAA,KAAK,EAALA,KAAAA;AAjBE,KAAD,CADc,CAAA;GAAnB,CAAA;;AAqBA,EAAA,IAAI,OAAOY,QAAP,KAAoB,UAAxB,EAAoC;IAClC,oBAAOd,qCAAA,eAAAC,uCAAA,CAAA,IAAA,CAAA,SAAA,QAAA,GAAA;AAAA,MAAA,IAAA,MAAA,GAAA,SAAA,CAAA;AAAA,MAAA,OAAAA,uCAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,QAAA,OAAA,CAAA,EAAA;AAAA,UAAA,QAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,YAAA,KAAA,CAAA;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,cAAA,OACCmB,UAAU,EADX,CAAA;;AAAA,YAAA,KAAA,CAAA;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,CAAA,CAAA;cAAA,OAEQN,QAAQ,MAAR,CAFR,KAAA,CAAA,EAAA,MAAA,CAAA,CAAA;;AAAA,YAAA,KAAA,CAAA;AAAA,cAAA,OAAA,SAAA,CAAA,MAAA,CAAA,QAAA,EAAA,SAAA,CAAA,IAAA,CAAA,CAAA;;AAAA,YAAA,KAAA,CAAA,CAAA;AAAA,YAAA,KAAA,KAAA;AAAA,cAAA,OAAA,SAAA,CAAA,IAAA,EAAA,CAAA;AAAA,WAAA;AAAA,SAAA;AAAA,OAAA,EAAA,QAAA,CAAA,CAAA;KAAP,CAAA,CAAA,CAAA;AAID,GAAA;;AACD,EAAA,OAAOM,UAAU,EAAjB,CAAA;AACD,CAxCD;;;;;"}